[build]
  publish = "dist"
  command = "npm run build"

[build.environment]
  NODE_VERSION = "18"

[[forms]]
  name = "contact"
  [[forms.notifications]]
    type = "email"
    to = "services@paramountpropertyrestoration.com"
    subject = "ðŸ“¬ New Contact Form Submission"
    body = """
    NEW CONTACT REQUEST:
    
    Name: {{ form.name }}
    Email: {{ form.email }}
    Phone: {{ form.phone }}
    Address: {{ form.address }}
    Service Type: {{ form.subject }}
    Message: {{ form.message }}
    
    Timestamp: {{ form.created_at }}
    """

[[forms]]
  name = "emergency-request"
  # Configure notifications
  [[forms.notifications]]
    type = "email"
    to = "services@paramountpropertyrestoration.com"
    subject = "ðŸš¨ Emergency Service Request - {{ form.city }}"
    body = """
    NEW EMERGENCY REQUEST:
    
    Name: {{ form.name }}
    Phone: {{ form.phone }}
    Service: {{ form.service }}
    City: {{ form.city }}
    Description: {{ form.description }}
    
    Timestamp: {{ form.created_at }}
    """

[[forms]]
  name = "mold-landing"
  # Configure notifications
  [[forms.notifications]]
    type = "email"
    to = "services@paramountpropertyrestoration.com"
    subject = "ðŸš¨ Mold Landing - Free Visual Inspection Request"
    body = """
    NEW MOLD LANDING LEAD:
    
    Name: {{ form.name }}
    Phone: {{ form.phone }}
    Email: {{ form.email }}
    Property Type: {{ form.property_type }}
    Description: {{ form.description }}
    Urgency: {{ form.urgency }}
    
    Timestamp: {{ form.created_at }}
    """

# Headers for better performance
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"

[[headers]]
  for = "*.js"
  [headers.values]
    Cache-Control = "public, max-age=31536000"

[[headers]]
  for = "*.css"
  [headers.values]
    Cache-Control = "public, max-age=31536000"

[[headers]]
  for = "*.png"
  [headers.values]
    Cache-Control = "public, max-age=31536000"

[[headers]]
  for = "*.jpg"
  [headers.values]
    Cache-Control = "public, max-age=31536000"

[[headers]]
  for = "*.jpeg"
  [headers.values]
    Cache-Control = "public, max-age=31536000"

[[headers]]
  for = "*.webp"
  [headers.values]
    Cache-Control = "public, max-age=31536000"

# ============================================================
# CANONICAL URL ENFORCEMENT - NO TRAILING SLASHES
# ============================================================
# Critical for SEO: These redirects ensure only ONE version of 
# each URL is accessible, preventing duplicate content issues
# and "non-indexable/canonicalized" errors in search engines
# ============================================================

# Programmatic service-city pages (most important for local SEO)
[[redirects]]
  from = "/services/:service/:city/"
  to = "/services/:service/:city"
  status = 301

# Restoration service-subservice-city detail pages
[[redirects]]
  from = "/restoration/:service/:subservice/:city/"
  to = "/restoration/:service/:subservice/:city"
  status = 301

# Restoration service-subservice hub pages (no city)
[[redirects]]
  from = "/restoration/:group/:subservice/"
  to = "/restoration/:group/:subservice"
  status = 301

# Static service pages
[[redirects]]
  from = "/services/bathroom-remodeling/"
  to = "/services/bathroom-remodeling"
  status = 301

[[redirects]]
  from = "/services/kitchen-remodeling/"
  to = "/services/kitchen-remodeling"
  status = 301

[[redirects]]
  from = "/services/bedroom-remodeling/"
  to = "/services/bedroom-remodeling"
  status = 301

[[redirects]]
  from = "/services/living-dining-remodeling/"
  to = "/services/living-dining-remodeling"
  status = 301

[[redirects]]
  from = "/services/home-additions-remodeling/"
  to = "/services/home-additions-remodeling"
  status = 301

# Static restoration category pages
[[redirects]]
  from = "/restoration/water-damage/"
  to = "/restoration/water-damage"
  status = 301

[[redirects]]
  from = "/restoration/fire-damage/"
  to = "/restoration/fire-damage"
  status = 301

[[redirects]]
  from = "/restoration/mold-remediation/"
  to = "/restoration/mold-remediation"
  status = 301

[[redirects]]
  from = "/restoration/storm-damage/"
  to = "/restoration/storm-damage"
  status = 301

[[redirects]]
  from = "/restoration/mitigation-services/"
  to = "/restoration/mitigation-services"
  status = 301

# Top-level section pages
[[redirects]]
  from = "/services/"
  to = "/services"
  status = 301

[[redirects]]
  from = "/restoration/"
  to = "/restoration"
  status = 301

# Other important pages
[[redirects]]
  from = "/contact/"
  to = "/contact"
  status = 301

[[redirects]]
  from = "/portfolio/"
  to = "/portfolio"
  status = 301

[[redirects]]
  from = "/book-mold-inspection/"
  to = "/book-mold-inspection"
  status = 301