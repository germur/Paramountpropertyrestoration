---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { restorationGroups } from "../../../data/restoration.js";
import { getSubserviceContent } from "../../../data/subservice-content.js";

import UnifiedTemplate from "../../../components/restoration/templates/UnifiedTemplate.astro";

export async function getStaticPaths() {
    const combinations = [];
    
    // Solo servicios de restauración (sin ciudades)
    restorationGroups.forEach(group => {
        group.subservices.forEach(subservice => {
            combinations.push({
                params: {
                    group: group.slug,
                    subservice: subservice.slug
                },
                props: {
                    groupData: {
                        name: group.name,
                        slug: group.slug,
                        template: group.template || "generic",
                        description: group.description
                    },
                    subData: {
                        ...subservice,
                        groupSlug: group.slug,
                        groupName: group.name,
                        template: group.template
                    }
                }
            });
        });
    });
    
    return combinations;
}

const { groupData, subData } = Astro.props;

// Obtener contenido específico del subservicio
const specificContent = getSubserviceContent(subData.slug);

// Si hay contenido específico, usarlo; si no, usar el genérico
const finalSubData = specificContent ? {
  ...subData,
  hero: specificContent.hero,
  process: specificContent.process,
  services: specificContent.services,
  features: specificContent.features,
  faqs: specificContent.faqs
} : subData;

const pageTitle =
    finalSubData?.seo?.title ??
    `${finalSubData.title} | ${groupData.name} | Paramount Property Restoration`;
const pageDescription = finalSubData?.seo?.description ?? `Professional ${finalSubData.title} services in Florida by Paramount Property Restoration`;

---

<BaseLayout title={pageTitle} description={pageDescription}>
    <UnifiedTemplate group={groupData} sub={finalSubData} />
</BaseLayout>