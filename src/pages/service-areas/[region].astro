---
import BaseLayout from "../../layouts/BaseLayout.astro";
import SEOHead from "../../components/SEOHead.jsx";
import { cities } from "../../data/locations.js";
import { regionalContent } from "../../data/regional-content.js";

export async function getStaticPaths() {
    const regions = [
        "central-florida",
        "tampa-bay",
        "southwest-florida",
        "south-florida",
        "treasure-coast",
    ];

    return regions.map((region) => ({
        params: { region },
        props: { regionSlug: region },
    }));
}

const { regionSlug } = Astro.props;
const data = regionalContent[regionSlug];
const regionCities = cities.filter(
    (c) => c.region.replace(/\s+/g, "-").toLowerCase() === regionSlug,
);

// Fallback if content missing (Safety)
if (!data) {
    throw new Error(`Missing content for region: ${regionSlug}`);
}
---

<BaseLayout
    title={`${data.title} | Paramount Property Restoration`}
    description={data.metaDescription}
>
    <SEOHead
        title={data.title}
        description={data.metaDescription}
        siteUrl="https://paramountpropertyrestoration.com"
        vertical="locations"
        city={null}
        service={null}
        subservice={null}
        addressLocality={null}
        slot="head"
    />

    <section class="region-hero">
        <div class="container hero-content">
            <span class="region-badge"
                >Serving {
                    regionSlug
                        .replace(/-/g, " ")
                        .replace(/\b\w/g, (l) => l.toUpperCase())
                }</span
            >
            <h1>{data.title}</h1>
            <p class="hero-intro">{data.intro}</p>
        </div>
    </section>

    <div class="layout-grid container">
        <main class="main-content">
            <section class="content-block">
                <h2>Regional Challenges & Solutions</h2>
                <div class="risks-grid">
                    {
                        data.climateRisks.map((risk) => (
                            <div class="risk-card">
                                <h3>
                                    <i class="fas fa-exclamation-circle" />{" "}
                                    {risk.title}
                                </h3>
                                <p>{risk.description}</p>
                            </div>
                        ))
                    }
                </div>
            </section>

            <section class="content-block">
                <h2>Insurance & Local Coverage</h2>
                <p>{data.insuranceContext}</p>
                <div class="county-list">
                    <strong>Counties Served:</strong>
                    {data.counties.join(", ")}
                </div>
            </section>

            <section class="cities-section">
                <h2>Cities We Serve in this Region</h2>
                <ul class="city-links">
                    {
                        regionCities.map((city) => (
                            <li style="color: #64748b; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i
                                    class="fas fa-map-pin"
                                    style="color: #cbd5e1;"
                                />
                                <span>{city.name}</span>
                            </li>
                        ))
                    }
                </ul>
                <p
                    style="font-size: 0.9rem; color: #94a3b8; margin-top: 1rem; font-style: italic;"
                >
                    * Individual city pages are currently being consolidated
                    into this Regional Hub.
                </p>
            </section>
        </main>

        <aside class="sidebar">
            <div class="service-focus-card">
                <h3>Local Focus</h3>
                <p>{data.serviceFocus}</p>
            </div>
            <div class="cta-card">
                <h3>Emergency in {regionSlug.replace(/-/g, " ")}?</h3>
                <p>Our local team is ready to deploy.</p>
                <a href="tel:7866022217" class="btn-call">(786) 602-2217</a>
            </div>
        </aside>
    </div>
</BaseLayout>

<style>
    .region-hero {
        background: #0b2545;
        color: white;
        padding: 5rem 1rem;
        text-align: center;
    }

    .region-badge {
        background: #e67e22;
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: bold;
        text-transform: uppercase;
        display: inline-block;
        margin-bottom: 1rem;
    }

    .hero-content h1 {
        font-size: 2.5rem;
        margin-bottom: 1rem;
    }

    .hero-intro {
        font-size: 1.2rem;
        max-width: 800px;
        margin: 0 auto;
        opacity: 0.9;
    }

    .layout-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 3rem;
        padding: 4rem 1rem;
    }

    .content-block {
        margin-bottom: 3rem;
    }

    .content-block h2 {
        font-size: 1.8rem;
        color: #0b2545;
        margin-bottom: 1.5rem;
        border-bottom: 2px solid #eee;
        padding-bottom: 0.5rem;
    }

    .risks-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
    }

    .risk-card {
        background: #f8f9fa;
        padding: 1.5rem;
        border-radius: 8px;
        border-left: 4px solid #e74c3c;
    }

    .risk-card h3 {
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
        color: #333;
    }

    .risk-card i {
        color: #e74c3c;
        margin-right: 0.5rem;
    }

    .county-list {
        margin-top: 1rem;
        background: #eef2f7;
        padding: 1rem;
        border-radius: 6px;
    }

    .cities-section h2 {
        font-size: 1.8rem;
        color: #0b2545;
        margin-bottom: 1.5rem;
        border-bottom: 2px solid #eee;
        padding-bottom: 0.5rem;
    }

    .city-links {
        list-style: none;
        padding: 0;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap: 1rem;
    }

    .city-links a {
        text-decoration: none;
        color: #3498db;
        font-weight: 500;
    }

    .city-links i {
        color: #ccc;
        margin-right: 0.5rem;
    }

    .city-links a:hover {
        color: #0b2545;
    }

    /* Sidebar */
    .service-focus-card,
    .cta-card {
        background: #f4f4f4;
        padding: 2rem;
        border-radius: 8px;
        margin-bottom: 2rem;
    }

    .service-focus-card h3 {
        margin-bottom: 1rem;
        color: #0b2545;
    }

    .cta-card {
        background: #0b2545;
        color: white;
        text-align: center;
    }

    .cta-card h3 {
        color: white;
        margin-bottom: 1rem;
    }

    .btn-call {
        background: #e67e22;
        color: white;
        display: block;
        padding: 0.8rem;
        border-radius: 4px;
        text-decoration: none;
        font-weight: bold;
        margin-top: 1rem;
    }

    .btn-call:hover {
        background: #d35400;
    }

    @media (max-width: 900px) {
        .layout-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
