---
import { cities } from "../../../data/restoration.js";
import FAQ from "../../AcordeonServices";
import RestorationCTA from "../../RestorationCTA";
import { CONTACT_PHONE, BRAND_COLORS } from "../../../config/constants.js";

import "../../../styles/pages/water-damage.css";
import "@fortawesome/fontawesome-free/css/all.min.css";

import {
  generateFAQSchema,
  generateHowToSchema,
} from "../../EnhancedSchemas.jsx";
import { faqData } from "../../../data/faq.js";
import { getRestorationContent } from "../../../data/restoration-content.js";
import { processSteps } from "../../../data/process-steps.js";
import {
  Info,
  Zap,
  Check,
  ShieldAlert,
  AlertTriangle,
  Timer,
  Clock,
} from "lucide-react";

const { group, sub } = Astro.props;

// Map group slug to FAQ category
const categoryMap = {
  "water-damage": "water",
  "fire-damage": "fire",
  "storm-damage": "storm",
  "mold-remediation": "mold",
  "mitigation-services": "mitigation",
};
const faqCategory = categoryMap[group.slug] || "general";
const faqQuestions = faqData[faqCategory] || faqData.general;
const faqSchema = generateFAQSchema(faqQuestions);

// Generate HowTo schema if process steps exist for this service
const categorySteps = processSteps[faqCategory];
const serviceSteps = categorySteps?.[sub.slug];
let howToSchema = null;
if (serviceSteps) {
  const canonicalURL = `https://paramountpropertyrestoration.com/restoration/${group.slug}/${sub.slug}`;
  howToSchema = generateHowToSchema({
    name: serviceSteps.name,
    description: serviceSteps.description,
    image: serviceSteps.image,
    totalTime: serviceSteps.totalTime,
    steps: serviceSteps.steps,
    url: canonicalURL,
  });
}

// Enhanced data structure for the unified template
const getEnhancedServiceData = (groupSlug, subSlug) => {
  // Map group slug to content type
  const typeMap = {
    "water-damage": "water",
    "fire-damage": "fire",
    "mold-remediation": "mold",
    "storm-damage": "storm",
    "mitigation-services": "mitigation",
  };

  const contentType = typeMap[groupSlug];

  // Try to get specific content from restoration-content.js
  const specificContent = contentType
    ? getRestorationContent(contentType, subSlug)
    : null;

  // If we have specific content, use it
  if (specificContent) {
    return {
      hero: {
        title:
          specificContent.hero?.titleFallback ||
          specificContent.hero?.title ||
          `${sub.title} Experts in Florida: 24/7 Emergency Service`,
        description:
          specificContent.hero?.description ||
          `Professional ${sub.title.toLowerCase()} services across Florida. Emergency response, certified technicians, and insurance coordination available 24/7.`,
        ctaText:
          specificContent.hero?.cta ||
          specificContent.hero?.ctaText ||
          "Call Now for Emergency Help",
        ctaPhone: CONTACT_PHONE,
        urgencyBadge:
          specificContent.hero?.urgencyBadge ||
          "24/7 Emergency Response Available",
        bgImage:
          specificContent.hero?.bgImage ||
          sub?.hero?.bgImage ||
          "/images/herowater.webp",
      },
      services: specificContent.services || [],
      features: specificContent.features || [
        "IICRC Certified Technicians",
        "Advanced Equipment",
        "Direct Insurance Billing",
        "24/7 Emergency Response",
      ],
      warningSigns: specificContent.warningSigns || [],
      process: specificContent.steps || [
        {
          step: 1,
          title: "Emergency Response",
          description: "Immediate assessment & stabilization",
          icon: "fas fa-shield-alt",
        },
        {
          step: 2,
          title: "Professional Service",
          description: "Certified technicians perform work",
          icon: "fas fa-tools",
        },
        {
          step: 3,
          title: "Quality Assurance",
          description: "Complete documentation & approval",
          icon: "fas fa-certificate",
        },
      ],
      education: specificContent.education,
    };
  }

  // Fallback to generic data if no specific content found
  const baseData = {
    hero: {
      title:
        sub?.hero?.title ||
        `${sub.title} Experts in Florida: 24/7 Emergency Service`,
      description:
        sub?.hero?.description ||
        `Professional ${sub.title.toLowerCase()} services across Florida. Emergency response, certified technicians, and insurance coordination available 24/7.`,
      ctaText: "Call Now for Emergency Help",
      ctaPhone: CONTACT_PHONE,
      urgencyBadge: "24/7 Emergency Response Available",
      bgImage: sub?.hero?.bgImage || "/images/herowater.webp",
    },
    services: [
      {
        name: "Emergency Assessment",
        icon: "fas fa-search",
        description: "Complete damage evaluation",
      },
      {
        name: "Professional Equipment",
        icon: "fas fa-tools",
        description: "Advanced restoration tools",
      },
      {
        name: "Insurance Coordination",
        icon: "fas fa-handshake",
        description: "Direct billing assistance",
      },
      {
        name: "Licensed Technicians",
        icon: "fas fa-certificate",
        description: "IICRC certified experts",
      },
      {
        name: "Quality Guarantee",
        icon: "fas fa-shield-alt",
        description: "Satisfaction assured",
      },
      {
        name: "24/7 Response",
        icon: "fas fa-clock",
        description: "Always available",
      },
    ],
    features: [
      "IICRC Certified Technicians",
      "Advanced Moisture Detection Equipment",
      "Direct Insurance Billing",
      "24/7 Emergency Response",
      "Antimicrobial Treatments",
      "Complete Documentation Process",
    ],
    warningSigns: [
      "Unusual odors or musty smells",
      "Visible staining or discoloration",
      "Soft or warped building materials",
      "Unexplained increases in utility bills",
      "Signs of moisture or humidity",
    ],
    process: [
      {
        step: 1,
        title: "Site Security",
        description: "Emergency assessment & stabilization",
        icon: "fas fa-shield-alt",
      },
      {
        step: 2,
        title: "Professional Restoration",
        description: "Certified technicians perform work",
        icon: "fas fa-tools",
      },
      {
        step: 3,
        title: "Quality Assurance",
        description: "Complete documentation & approval",
        icon: "fas fa-certificate",
      },
    ],
    education: null,
  };
  return baseData;
};

const serviceData = getEnhancedServiceData(group.slug, sub.slug);

// City data for regional display
const getCitiesByRegion = () => {
  const regions = {};
  cities.forEach((city) => {
    if (!regions[city.region]) {
      regions[city.region] = [];
    }
    regions[city.region].push(city);
  });
  return regions;
};

const cityRegions = getCitiesByRegion();
---

<!-- Inject FAQ Schema -->
<script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />

<!-- Inject HowTo Schema (if available) -->{
  howToSchema && (
    <script type="application/ld+json" set:html={JSON.stringify(howToSchema)} />
  )
}

<div class="unified-service-template">
  <!-- Compact Hero Section -->
  <section
    class="hero-section"
    style={`background-image: url('${serviceData.hero.bgImage || "/images/herowater.webp"}'); height: 450px;`}
  >
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <div class="hero-badge">
        <i class="fas fa-clock"></i>
        {serviceData.hero.urgencyBadge}
      </div>
      <h1>{serviceData.hero.title}</h1>
      <p>{serviceData.hero.description}</p>
      <div class="hero-actions">
        <a href={`tel:${serviceData.hero.ctaPhone}`} class="cta-button primary">
          <i class="fas fa-phone"></i>
          {serviceData.hero.ctaText}
        </a>
      </div>
    </div>
  </section>

  <!-- NEW: Educational "What is [Service]?" Section (Airbnb-style UX) -->
  <section class="section" style="background: white; padding: 4rem 0;">
    <div class="container" style="max-width: 1200px;">
      <!-- Header -->
      <div style="text-align: center; margin-bottom: 3rem;">
        <span
          style={`color: ${BRAND_COLORS.primary}; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; font-size: 0.9rem;`}
        >
          Expert Knowledge
        </span>
        <h2
          style="color: #1a202c; font-size: 2.25rem; margin-top: 0.5rem; font-weight: 800;"
        >
          Understanding {sub.title}
        </h2>
      </div>

      <!-- Overview Section: 2-Column Layout -->
      <div
        style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: center; margin-bottom: 4rem;"
      >
        <!-- Left: Text -->
        <div>
          <p
            style="color: #4a5568; line-height: 1.8; font-size: 1.1rem; margin: 0;"
          >
            {
              serviceData.education?.overview ||
                `${sub.title} is a serious property emergency that requires immediate professional intervention. Whether caused by natural disasters, structural failures, or equipment malfunctions, the damage can escalate rapidly if not addressed within the first 24-48 hours. Our IICRC-certified technicians use advanced detection equipment and proven restoration methods to stop the damage, prevent secondary issues like mold growth, and restore your property to pre-loss condition.`
            }
          </p>
        </div>
        <!-- Right: Visual Highlight (Airbnb-style "Key Takeaway" Box) -->
        <div
          style="background: #f7fafc; border-radius: 16px; padding: 2rem; border: 1px solid #edf2f7;"
        >
          <div style="display: flex; align-items: start; margin-bottom: 1rem;">
            <div
              style={`background: ${BRAND_COLORS.primary}20; color: ${BRAND_COLORS.primary}; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; flex-shrink: 0;`}
            >
              <Info size={24} />
            </div>
            <div>
              <h4
                style="margin: 0 0 0.5rem 0; color: #2d3748; font-size: 1.1rem;"
              >
                Why Speed Matters
              </h4>
              <p
                style="margin: 0; color: #718096; font-size: 0.95rem; line-height: 1.6;"
              >
                Time is critical. Every hour of delay increases repair costs and
                health risks. Immediate action within 24-48 hours can save
                thousands in secondary damage.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- 3-Column Grid: Visual Feature Lists -->
      <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;"
      >
        <!-- Card 1: Causes -->
        <div style="padding: 0;">
          <div
            style="display: flex; align-items: center; margin-bottom: 1.5rem;"
          >
            <Zap size={24} color="#e53e3e" style={{ marginRight: "0.75rem" }} />
            <h3
              style="font-size: 1.25rem; font-weight: 700; color: #2d3748; margin: 0;"
            >
              Common Causes
            </h3>
          </div>
          <ul style="list-style: none; padding: 0; margin: 0;">
            {
              (
                serviceData.education?.causes || [
                  "Natural disasters and severe weather",
                  "Plumbing failures and pipe bursts",
                  "Appliance malfunctions",
                  "Structural deterioration",
                  "Human error or negligence",
                ]
              ).map((item) => (
                <li style="display: flex; align-items: start; margin-bottom: 1rem; color: #4a5568;">
                  <i
                    class="fas fa-check"
                    style="color: #cbd5e0; margin-right: 0.75rem; margin-top: 4px;"
                  />
                  <span style="line-height: 1.6;">{item}</span>
                </li>
              ))
            }
          </ul>
        </div>

        <!-- Card 2: Risks -->
        <div style="padding: 0;">
          <div
            style="display: flex; align-items: center; margin-bottom: 1.5rem;"
          >
            <ShieldAlert
              size={24}
              color="#dd6b20"
              style={{ marginRight: "0.75rem" }}
            />
            <h3
              style="font-size: 1.25rem; font-weight: 700; color: #2d3748; margin: 0;"
            >
              Health Risks
            </h3>
          </div>
          <ul style="list-style: none; padding: 0; margin: 0;">
            {
              (
                serviceData.education?.risks || [
                  "Respiratory issues from contaminants",
                  "Mold and bacteria growth",
                  "Structural instability hazards",
                  "Electrical shock dangers",
                  "Toxic material exposure",
                ]
              ).map((item) => (
                <li style="display: flex; align-items: start; margin-bottom: 1rem; color: #4a5568;">
                  <i
                    class="fas fa-exclamation-triangle"
                    style="color: #f6ad55; margin-right: 0.75rem; margin-top: 4px;"
                  />
                  <span style="line-height: 1.6;">{item}</span>
                </li>
              ))
            }
          </ul>
        </div>

        <!-- Card 3: Urgency -->
        <div style="padding: 0;">
          <div
            style="display: flex; align-items: center; margin-bottom: 1.5rem;"
          >
            <Timer
              size={24}
              color="#3182ce"
              style={{ marginRight: "0.75rem" }}
            />
            <h3
              style="font-size: 1.25rem; font-weight: 700; color: #2d3748; margin: 0;"
            >
              Urgency Factors
            </h3>
          </div>
          <ul style="list-style: none; padding: 0; margin: 0;">
            {
              (
                serviceData.education?.urgency || [
                  "Damage spreads exponentially",
                  "Repair costs increase daily",
                  "Insurance claims require documentation",
                  "Mold can develop in 24-48 hours",
                  "Property value depreciation",
                ]
              ).map((item) => (
                <li style="display: flex; align-items: start; margin-bottom: 1rem; color: #4a5568;">
                  <i
                    class="fas fa-clock"
                    style="color: #63b3ed; margin-right: 0.75rem; margin-top: 4px;"
                  />
                  <span style="line-height: 1.6;">{item}</span>
                </li>
              ))
            }
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Services Grid Section -->
  <section class="section" style="background: #f8f9fa; padding: 3rem 0;">
    <div class="container">
      <h2
        style="text-align: center; color: #333; font-size: 2rem; margin-bottom: 2.5rem;"
      >
        Our Comprehensive {sub.title} Solutions
      </h2>
      <div class="services-grid">
        {
          serviceData.services.map((service) => (
            <div class="service-item">
              <i class={service.icon} />
              <h3>{service.title || service.name}</h3>
              {service.description && (
                <p class="service-description">{service.description}</p>
              )}
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- ENHANCED: Expanded Service Overview Section -->
  <section
    class="section service-overview"
    style="background: white; padding: 4rem 0;"
  >
    <div class="container" style="max-width: 1200px;">
      <div style="max-width: 900px; margin: 0 auto;">
        <h2 style="color: #333; font-size: 2rem; margin-bottom: 1.5rem;">
          Professional {sub.title} Services You Can Trust
        </h2>

        <!-- Main Overview Content -->
        <div style="margin-bottom: 3rem;">
          <p
            style="color: #555; line-height: 1.8; font-size: 1.05rem; margin-bottom: 1.5rem;"
          >
            When disaster strikes, you need a restoration partner with proven
            expertise, advanced equipment, and a commitment to excellence. Our {
              sub.title.toLowerCase()
            } services combine cutting-edge technology with decades of hands-on experience
            to deliver results that exceed industry standards. We don't just fix
            the visible damage—we identify and address underlying issues to prevent
            future problems.
          </p>

          <h3
            style="color: #333; font-size: 1.4rem; margin-bottom: 1rem; margin-top: 2rem;"
          >
            <i
              class="fas fa-tools"
              style={`color: ${BRAND_COLORS.primary}; margin-right: 0.5rem;`}
            ></i>
            Our Professional Approach
          </h3>
          <p
            style="color: #555; line-height: 1.8; font-size: 1.05rem; margin-bottom: 1.5rem;"
          >
            Every project begins with a comprehensive assessment using thermal
            imaging cameras, moisture meters, and air quality testing equipment.
            Our IICRC-certified technicians develop a customized restoration
            plan tailored to your specific situation, property type, and
            insurance requirements. We use commercial-grade extraction
            equipment, industrial dehumidifiers, and EPA-approved antimicrobial
            treatments to ensure thorough, lasting results.
          </p>

          <h3
            style="color: #333; font-size: 1.4rem; margin-bottom: 1rem; margin-top: 2rem;"
          >
            <i
              class="fas fa-shield-alt"
              style={`color: ${BRAND_COLORS.primary}; margin-right: 0.5rem;`}
            ></i>
            What Sets Us Apart
          </h3>
          <div
            style="background: #f8f9fa; border-radius: 12px; padding: 2rem; margin-bottom: 2rem;"
          >
            <div
              style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;"
            >
              <div>
                <h4
                  style="color: #333; font-size: 1.1rem; margin-bottom: 0.5rem;"
                >
                  <i
                    class="fas fa-certificate"
                    style={`color: ${BRAND_COLORS.primary}; margin-right: 0.5rem;`}
                  ></i>
                  Certified Experts
                </h4>
                <p style="color: #666; line-height: 1.6; margin: 0;">
                  IICRC-certified technicians with 15+ years of experience and
                  ongoing training in latest restoration techniques.
                </p>
              </div>
              <div>
                <h4
                  style="color: #333; font-size: 1.1rem; margin-bottom: 0.5rem;"
                >
                  <i
                    class="fas fa-clock"
                    style={`color: ${BRAND_COLORS.primary}; margin-right: 0.5rem;`}
                  ></i>
                  Rapid Response
                </h4>
                <p style="color: #666; line-height: 1.6; margin: 0;">
                  24/7 emergency service with 60-minute response time guarantee
                  across all Florida service areas.
                </p>
              </div>
              <div>
                <h4
                  style="color: #333; font-size: 1.1rem; margin-bottom: 0.5rem;"
                >
                  <i
                    class="fas fa-handshake"
                    style={`color: ${BRAND_COLORS.primary}; margin-right: 0.5rem;`}
                  ></i>
                  Insurance Experts
                </h4>
                <p style="color: #666; line-height: 1.6; margin: 0;">
                  Direct billing with all major insurers, complete
                  documentation, and claims advocacy to maximize your coverage.
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Warning Signs Section - Enhanced -->
        {
          serviceData.warningSigns && serviceData.warningSigns.length > 0 && (
            <div style="background: linear-gradient(135deg, #fff5f5 0%, #ffe5e5 100%); border: 2px solid #e74c3c; border-radius: 12px; padding: 2rem; margin-bottom: 2rem;">
              <h3 style="color: #c0392b; font-size: 1.4rem; margin-bottom: 1.5rem; display: flex; align-items: center;">
                <i
                  class="fas fa-exclamation-triangle"
                  style="margin-right: 0.75rem; font-size: 1.6rem;"
                />
                Critical Warning Signs - Call Immediately If You Notice:
              </h3>
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem;">
                {serviceData.warningSigns.map((sign) => (
                  <div style="background: white; border-radius: 8px; padding: 1rem; display: flex; align-items: start; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                    <i
                      class="fas fa-check-circle"
                      style={`color: ${BRAND_COLORS.primary}; margin-right: 0.75rem; margin-top: 0.25rem; font-size: 1.2rem; flex-shrink: 0;`}
                    />
                    <span style="color: #555; line-height: 1.6;">{sign}</span>
                  </div>
                ))}
              </div>
              <div style="text-align: center; margin-top: 1.5rem;">
                <a
                  href={`tel:${CONTACT_PHONE}`}
                  style={`
                  background: #e74c3c;
                  color: white;
                  text-decoration: none;
                  padding: 1rem 2rem;
                  border-radius: 30px;
                  font-weight: 700;
                  font-size: 1.1rem;
                  display: inline-flex;
                  align-items: center;
                  gap: 0.75rem;
                  transition: all 0.3s ease;
                  box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
                `}
                  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(231, 76, 60, 0.4)'"
                  onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(231, 76, 60, 0.3)'"
                >
                  <i class="fas fa-phone-alt" />
                  CALL NOW - 24/7 EMERGENCY RESPONSE
                </a>
              </div>
            </div>
          )
        }

        <!-- Features List -->
        {
          serviceData.features && serviceData.features.length > 0 && (
            <div style="margin-bottom: 2rem;">
              <h3 style="color: #333; font-size: 1.4rem; margin-bottom: 1.5rem;">
                <i
                  class="fas fa-star"
                  style={`color: ${BRAND_COLORS.primary}; margin-right: 0.5rem;`}
                />
                Why Choose Our {sub.title} Services
              </h3>
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                {serviceData.features.map((feature) => (
                  <div style="background: #f8f9fa; border-left: 4px solid {BRAND_COLORS.primary}; padding: 1rem 1.5rem; border-radius: 6px;">
                    <span style="color: #555; font-size: 1.05rem; line-height: 1.6;">
                      <i
                        class="fas fa-check"
                        style={`color: ${BRAND_COLORS.primary}; margin-right: 0.75rem;`}
                      />
                      {feature}
                    </span>
                  </div>
                ))}
              </div>
            </div>
          )
        }
      </div>
    </div>
  </section>

  <!-- ENHANCED: Full-Width Process Section (moved from sidebar) -->
  <section
    class="section"
    style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 4rem 0;"
  >
    <div class="container" style="max-width: 1200px;">
      <div style="text-align: center; margin-bottom: 3rem;">
        <h2 style="color: #333; font-size: 2rem; margin-bottom: 1rem;">
          <i
            class="fas fa-clipboard-list"
            style={`color: ${BRAND_COLORS.primary}; margin-right: 0.75rem;`}
          ></i>
          Our Proven {sub.title} Process
        </h2>
        <p
          style="color: #666; font-size: 1.1rem; max-width: 700px; margin: 0 auto;"
        >
          We follow a systematic, industry-leading approach to ensure complete
          restoration and your peace of mind.
        </p>
      </div>

      <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; max-width: 1100px; margin: 0 auto;"
      >
        {
          serviceData.process.map((step, index) => (
            <div
              style={`background: white; border-radius: 12px; padding: 2rem; box-shadow: 0 4px 20px rgba(0,0,0,0.08); position: relative; border-top: 4px solid ${BRAND_COLORS.primary};`}
            >
              <div
                style={`
                position: absolute;
                top: -20px;
                left: 50%;
                transform: translateX(-50%);
                background: ${BRAND_COLORS.primary};
                color: #ffffff;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.8rem;
                font-weight: 700;
                box-shadow: 0 4px 15px rgba(53, 195, 233, 0.4);
                line-height: 1;
              `}
              >
                <span style="color: #ffffff; font-weight: 700;">
                  {index + 1}
                </span>
              </div>
              <div style="margin-top: 1.5rem; text-align: center;">
                <i
                  class={step.icon || "fas fa-cog"}
                  style="font-size: 2.5rem; color: #35c3e9; margin-bottom: 1rem; opacity: 0.8;"
                />
                <h3 style="color: #333; font-size: 1.3rem; margin-bottom: 0.75rem; font-weight: 600;">
                  {step.title}
                </h3>
                <p style="color: #666; line-height: 1.7; font-size: 1rem; margin: 0;">
                  {step.description}
                </p>
              </div>
            </div>
          ))
        }
      </div>

      <!-- Insurance Help Section -->
      <div
        style="background: white; border-radius: 12px; padding: 2.5rem; margin-top: 3rem; max-width: 800px; margin-left: auto; margin-right: auto; box-shadow: 0 4px 20px rgba(0,0,0,0.08);"
      >
        <div style="text-align: center;">
          <i
            class="fas fa-handshake"
            style={`color: ${BRAND_COLORS.primary}; font-size: 3rem; margin-bottom: 1rem;`}
          ></i>
          <h3 style="color: #333; font-size: 1.5rem; margin-bottom: 1rem;">
            Insurance Claims Made Simple
          </h3>
          <p
            style="color: #666; line-height: 1.8; font-size: 1.05rem; margin-bottom: 1.5rem;"
          >
            We work directly with your insurance company, handling all
            documentation, communication, and negotiations to ensure you receive
            the maximum coverage you're entitled to. Our team has processed
            thousands of claims and knows exactly what insurers require for
            approval.
          </p>
          <a
            href="/contact"
            style={`
            background: ${BRAND_COLORS.primary};
            color: white;
            text-decoration: none;
            padding: 1rem 2.5rem;
            border-radius: 30px;
            font-weight: 700;
            font-size: 1.05rem;
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            transition: all 0.3s ease;
          `}
            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(53, 195, 233, 0.4)'"
            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'"
          >
            <i class="fas fa-file-invoice"></i>
            Get Free Insurance Assessment
          </a>
        </div>
      </div>
    </div>
  </section>
</div>

<!-- MINIMIZED: Cities Section - Compact Footer -->
<section
  class="section"
  style="padding: 2rem 0; background: #f8f9fa; border-top: 1px solid #e9ecef;"
>
  <div class="container" style="max-width: 1200px;">
    <div style="text-align: center; margin-bottom: 1.5rem;">
      <h3 style="color: #333; font-size: 1.3rem; margin-bottom: 0.5rem;">
        <i
          class="fas fa-map-marked-alt"
          style={`color: ${BRAND_COLORS.primary}; margin-right: 0.5rem;`}></i>
        Serving 50+ Cities Across Florida
      </h3>
      <p style="color: #666; font-size: 0.95rem;">
        24/7 emergency {sub.title.toLowerCase()} service available statewide
      </p>
    </div>

    <!-- Collapsible Cities Accordion (Collapsed by Default) -->
    <div style="max-width: 900px; margin: 0 auto;">
      <button
        id="cities-toggle"
        style={`
          width: 100%;
          background: white;
          border: 2px solid ${BRAND_COLORS.primary};
          border-radius: 8px;
          padding: 1rem 1.5rem;
          font-size: 1.05rem;
          font-weight: 600;
          color: ${BRAND_COLORS.primary};
          cursor: pointer;
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 0.75rem;
          transition: all 0.3s ease;
        `}
        onclick="
          const content = document.getElementById('cities-content');
          const icon = document.getElementById('cities-chevron');
          if (content.style.maxHeight && content.style.maxHeight !== '0px') {
            content.style.maxHeight = '0';
            icon.style.transform = 'rotate(0deg)';
            this.querySelector('span').textContent = 'View All Service Areas';
          } else {
            content.style.maxHeight = content.scrollHeight + 'px';
            icon.style.transform = 'rotate(180deg)';
            this.querySelector('span').textContent = 'Hide Service Areas';
          }
        "
        onmouseover="this.style.background='#f0f9ff'"
        onmouseout="this.style.background='white'"
      >
        <i class="fas fa-map-marker-alt"></i>
        <span>View All Service Areas</span>
        <i
          id="cities-chevron"
          class="fas fa-chevron-down"
          style="transition: transform 0.3s ease;"></i>
      </button>

      <div
        id="cities-content"
        style="
          max-height: 0;
          overflow: hidden;
          transition: max-height 0.4s ease;
        "
      >
        <div style="padding: 2rem 1rem;">
          {
            Object.entries(cityRegions).map(([regionName, regionCities]) => (
              <div style="margin-bottom: 2rem;">
                <h4 style="color: #333; font-size: 1.1rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #e9ecef;">
                  <i
                    class="fas fa-map-marked-alt"
                    style={`color: ${BRAND_COLORS.primary}; margin-right: 0.5rem;`}
                  />
                  {regionName} ({(regionCities as any[]).length} cities)
                </h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 0.75rem;">
                  {(regionCities as any[]).map((city) => (
                    <a
                      href={`/restoration/${group.slug}/${sub.slug}/${city.slug}`}
                      style="
                        text-decoration: none;
                        background: white;
                        border: 1px solid #e9ecef;
                        border-radius: 6px;
                        padding: 0.75rem 1rem;
                        transition: all 0.2s ease;
                        display: block;
                      "
                      onmouseover="this.style.borderColor='#35c3e9'; this.style.transform='translateX(4px)'"
                      onmouseout="this.style.borderColor='#e9ecef'; this.style.transform='translateX(0)'"
                    >
                      <div style="color: #333; font-weight: 600; font-size: 0.95rem; margin-bottom: 0.25rem;">
                        {city.nombre}
                      </div>
                      <div style="color: #999; font-size: 0.8rem;">
                        {city.condado} County
                      </div>
                    </a>
                  ))}
                </div>
              </div>
            ))
          }
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FAQ Section -->
<section class="section faq-section" style="padding-top: 2rem;">
  <div class="container">
    <h2 class="section-title">
      Frequently Asked Questions About {sub.title}
    </h2>
    <FAQ category={faqCategory} serviceName={sub.title} client:load />
  </div>
</section>

<!-- Final CTA -->
<RestorationCTA
  title="Need Expert Help Now?"
  subtitle="Don't wait - property damage gets worse over time"
  buttonText="Get Emergency Help →"
  client:load
/>

<script>
  // Regional accordion functionality
  function toggleRegion(regionId) {
    const content = document.getElementById(regionId);
    const chevron = document.getElementById(
      regionId.replace("region-", "chevron-"),
    );

    if (content && chevron) {
      if (content.style.maxHeight === "0px" || !content.style.maxHeight) {
        content.style.maxHeight = content.scrollHeight + "px";
        chevron.style.transform = "rotate(180deg)";
      } else {
        content.style.maxHeight = "0px";
        chevron.style.transform = "rotate(0deg)";
      }
    }
  }

  // Make function globally available
  (window as any).toggleRegion = toggleRegion;
</script>
